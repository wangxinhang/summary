<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <link href="../Styles/Page.css" rel="stylesheet" type="text/css" />
    <link href="../Styles/Query.css" rel="stylesheet" type="text/css" />
    <link href="../Styles/ScrollBar.css" rel="stylesheet" type="text/css" />
    <script src="../Scripts/jquery-1.11.1.js" type="text/javascript"></script>
    <script src="../SzdwControls/domCommon.js" type="text/javascript"></script>
    <script src="../SzdwControls/SzdwDropDownList.js" type="text/javascript"></script>
    <script src="../SzdwControls/SzdwButtonGroup.js" type="text/javascript"></script>
    <script src="../SzdwControls/SzdwGridView.js" type="text/javascript"></script>
    <link href="../SzdwControls/SzdwGridView.css" rel="stylesheet" type="text/css" />
    <script src="../SzdwControls/SzdwPagination.js" type="text/javascript"></script>
    <script src="../SzdwControls/SzdwButton.js" type="text/javascript"></script>
    <script src="../SzdwControls/SzdwPopupWindow.js" type="text/javascript"></script>
    <script src="../SzdwControls/SzdwInfoPanel.js" type="text/javascript"></script>
    <script src="../SzdwControls/SzdwValidator.js" type="text/javascript"></script>
    <script src="../SzdwControls/SzdwAjaxDataOperate.js" type="text/javascript"></script>
    <script src="../SzdwControls/SzdwCommon.js" type="text/javascript"></script>
    <script src="../Scripts/CommonJScript.js" type="text/javascript"></script>
    <script src="../Scripts/myparm.js" type="text/javascript"></script>
    <style type="text/css">
        input::-ms-clear {
            display: none;
        }
    </style>

</head>
<body style="background-color: #EEEEEE">
    <div id="queryPanel" class="queryPanelNew">
        <div id="filterPanel" class="filterPanel">
            <div id="row0">
                <div id="cell00" class="cellDiv">
                    <label for="txtName" class="label">用户名称:</label>
                    <input id="txtName" type="text" class="textBox2" style="width: 100px;" />
                </div>
                <div id="cell01" class="cellDiv">
                    <label for="txtNameCN" class="label">中文姓名:</label>
                    <input id="txtNameCN" type="text" class="textBox2" style="width: 100px;" />
                </div>
                <div id="cell02" class="cellDiv">
                    <label for="ddlDepartmentType" class="label">部门类型</label>
                    <input id="ddlDepartmentType" type="text" class="dropDownList" style="width: 90px;" />
                </div>
                <div id="cell00" class="cellDiv">
                    <label for="ddlDepartment" class="label">单位:</label>
                    <input id="ddlDepartment" type="text" class="dropDownList" style="width: 210px;" readonly="readonly" />
                </div>
            </div>
        </div>
        <div id="btnPanel" class="btnPanel2"></div>
    </div>
    <div id="dataPanel"></div>
    <script type="text/javascript">
        //#region 全局变量
        var xuserId, xmenuId, permission = {}; //权限json格式:{ accessPermission: false, insertPermission: false, deletePermission: false, modifyPermission: false, exportPrintPermission: false };
        var pwWidth = 320;
        //#endregion 全局变量

        $(document).ready(function () {
            //获取用户Id和MenuId
            var paramJson = SzdwCommon.getJsonParm();
            xuserId = paramJson.xuserId;
            xmenuId = paramJson.xmenuId;
            permission = SzdwCommon.getPermission(paramJson.permissionJsonList);
            bodyWidth = Math.max($(document.body).width(), minWidth);
            bodyHeight = Math.max($(document.body).height(), minHeight);
            //设置查询面板
            SetQueryPanel();
            //设置结果面板
            SetDataPanel();
            //窗口调整大小
            $(window).resize(function () {
                bodyWidth = Math.max($(document.body).width(), minWidth);
                bodyHeight = Math.max($(document.body).height(), minHeight);
                RepositionControls();
                ResizeControls();
            });
        });
 
        //#region 位置尺寸
        function RepositionControls() {
            var qh = GetPanelX("queryPanel", "h");
            var qx = GetPanelX("queryPanel", "x");
            var qy = GetPanelX("queryPanel", "y");
            $("#dataPanel").css({ "left": qx, "top": qy + qh + mt });

            //重设弹窗位置
            var t = document.body;
            var pw = t.popupWindow;
            if (pw) {
                pw.RePosition(bodyWidth - pw.width - ml, qy + qh + mt);
            }
            var epw = t.employeeWindow;
            if (epw) {
                epw.RePosition(pw.x - epw.width, pw.y);
            }
            var ew = t.exportWindow;
            if (ew) {
                var w = Math.max(exportWidth, bodyWidth * 4 / 5);
                var h = bodyHeight * 4 / 5;
                var x = (bodyWidth - w) / 2;
                var y = (bodyHeight - h) / 2;
                ew.RePosition(x, y);
            }
        }
        //重设网页元素尺寸
        function ResizeControls() {
            var qx = GetPanelX("queryPanel", "x");
            var qy = GetPanelX("queryPanel", "y");
            var qw = bodyWidth - 2 * ml;
            var qh = GetPanelX("queryPanel", "h");
            var dh = bodyHeight - qy - qh - 2 * mt;

            $("#queryPanel").outerWidth(bodyWidth - 2 * ml);

            if (szdwGv) {
                $("#dataPanel").outerWidth(qw).outerHeight(dh);
                szdwGv.Resize(qw, dh);
            }

            var t = document.body;
            var pw = t.popupWindow;
            if (pw) {
                pw.ReSize(pw.width, dh);
            }
            var epw = t.employeeWindow;
            if (epw) {
                epw.ReSize(epw.width, pw.height);
            }
            var ew = t.exportWindow;
            if (ew) {
                var w = Math.max(exportWidth, bodyWidth * 4 / 5);
                var h = bodyHeight * 4 / 5;
                ew.ReSize(w, h);
            }
        }
        //#endregion

        //#region 查询面板
        function SetQueryPanel() {
            $("#queryPanel").outerWidth(bodyWidth - ml * 2);
            $("#ddlDepartment").val("全部").data("value", "0");
            $("#ddlDepartmentType").val("全部").data("value", 0);
            BindDdlDepartmentType();
            //BindDdlDepartment(0);

            CreateButton();
            $("#txtName").keypress(function (e) {
                var k = e.which;
                if (k == 13) {
                    var btnPanel = szdwQueryButton.button;
                    $(btnPanel).trigger("click");
                }
            });
            $("#txtNameCN").keypress(function (e) {
                var k = e.which;
                if (k == 13) {
                    var btnPanel = szdwQueryButton.button;
                    $(btnPanel).trigger("click");
                }
            });
        }

        function SetDataPanel() {
            var qx = GetPanelX("queryPanel", "x");
            var qy = GetPanelX("queryPanel", "y");
            var qw = GetPanelX("queryPanel", "w");
            var qh = GetPanelX("queryPanel", "h");
            $("#dataPanel")
                .css({ "position": "relative", "left": qx, "top": qy + qh + mt })
                .outerWidth(qw)
                .outerHeight(bodyHeight - qy - qh - 2 * mt);
            //初始加载结果数据
            GetQueryResult();
        }

        function BindDdlDepartmentType() {
            $.ajax({
                url: "../Department/DepartmentTypeHandler.ashx",
                type: "post",
                data: {
                    MethodName: "GetDepartmentTypeNameList"
                },
                dataType: "json",
                success: function (jsData) {
                    if (jsData instanceof Array) {
                        var jsonList = new Array();
                        var len = jsData.length;
                        for (var i = 0; i < len; i++) {
                            jsonList.push({ Id: jsData[i].Id, Name: jsData[i].Name });
                        }
                        var paramDdl = { jsonList: jsonList, fnInitial: InitialDdlDepartmentType };
                        $("#ddlDepartmentType").dropDownList(paramDdl);
                        $("#ddlDepartmentType").val("全部").data("value", 0);
                        BindDdlDepartment(0);
                    }
                }
            });
        }

        function InitialDdlDepartmentType(szdwDdl) {
            szdwDdl.nonCascadeItemLength = 1;
            szdwDdl.jsonItemAll = { Id: 0, Name: "全部" };
            szdwDdl.fnItemClick = function () {
                BindDdlDepartment($("#ddlDepartmentType").data("value"));
                var btn = szdwQueryButton.button;
                $(btn).trigger("click");
            }
        }
        //#region 部门下拉框
        function BindDdlDepartment(departmentTypeId) {
            var requestUrl = "../Department/DepartmentHandler.ashx";
            var paramJson = { xuserId: xuserId, departmentTypeId: departmentTypeId, MethodName: "GetDepartmentListByDepartmentTypeId" };
            var paramDdl = { requestUrl: requestUrl, paramJson: paramJson, fnInitial: InitialDdlDepartment };
            $("#ddlDepartment").dropDownList(paramDdl);
            $("#ddlDepartment").val("全部").data("value", "0");
        }
        //初始化部门设置
        function InitialDdlDepartment(szdwDdl) {
            //初始化数据属性
            szdwDdl.nonCascadeItemLength = 0;
            //szdwDdl.hasSearchBox = 1;
            szdwDdl.jsonItemAll = { Id: "0", Name: "全部" };
            szdwDdl.fnItemClick = function () {
                console.log($("#ddlDepartment").data("value"));
                var btn = szdwQueryButton.button;
                $(btn).trigger("click");
            }
        }
        //#endregion 部门下拉框

        //#endregion 查询条件面板

        //#region 查询按钮面板

        //#region 创建按钮
        function CreateButton() {
            //创建按钮
            CreateQueryButton();
            //if (permission.exportPrintPermission) { CreateExportButton(); }
            CreateResetButton();
            CreateRetractButton();
            if (permission.insertPermission) { CreateInsertButton(); }
        }
        //#endregion 设置按钮面板

        //#region 查询按钮
        var szdwQueryButton = null;
        function CreateQueryButton() {
            var nc = $("#btnPanel");
            var p = "relative";
            var x = 0;
            var y = 0;
            var w = btnWidth;
            var h = btnHeight;
            szdwQueryButton = new SzdwButton(p, x, y, w, h);
            szdwQueryButton.namingContainer = nc;
            szdwQueryButton.image = imgFile.query;
            szdwQueryButton.text = "查询数据";
            szdwQueryButton.btnCssJson["border"] = "0px";
            szdwQueryButton.btnHoverCssJson = { "color": "#017BBA" };
            szdwQueryButton.imageWidth = btnImageWidth;
            szdwQueryButton.Load();

            //单击事件
            var btn = szdwQueryButton.button;
            $(btn).click(function (e) {
                e.stopPropagation();
                var name = $.trim($("#txtName").val());
                var nameCN = $.trim($("#txtNameCN").val());
                var departmentTypeId = $("#ddlDepartmentType").data("value");
                var departmentId = $("#ddlDepartment").data("value");
                if (szdwGv) {
                    szdwGv.paramJson["name"] = name;
                    szdwGv.paramJson["nameCN"] = nameCN;
                    szdwGv.paramJson["departmentTypeId"] = departmentTypeId;
                    szdwGv.paramJson["departmentId"] = departmentId;
                    szdwGv.DataBind();
                }
            });
        }

        //查询按钮事件
        var szdwExportButton = null;
        function CreateExportButton() {
            var nc = $("#btnPanel");
            var p = "relative";
            var x = 0;
            var y = 0;
            var w = btnWidth;
            var h = btnHeight;
            szdwExportButton = new SzdwButton(p, x, y, w, h);
            szdwExportButton.namingContainer = nc;
            szdwExportButton.image = imgFile.report;
            szdwExportButton.text = "导出打印";
            szdwExportButton.btnCssJson["border"] = "0px";
            szdwExportButton.btnCssJson["margin-left"] = "5px";
            szdwExportButton.btnCssJson["border-left"] = "1px solid #EEEEEE";
            szdwExportButton.btnHoverCssJson = { "color": "#017BBA" };
            szdwExportButton.imageWidth = btnImageWidth;
            szdwExportButton.Load();

            var btn = szdwExportButton.button;
            $(btn).click(function () {
                SzdwCommon.hideWin(document.body.popupWindow);
                var pageUrl = "EquipmentQueryReport.aspx";
                var paramJson = GetReportParamJson();
                var titleText = "用户信息导出打印";
                var w = Math.min(exportWidth, bodyWidth * 4 / 5);
                var h = Math.min(exportHeight, bodyHeight * 4 / 5);
                var x = (bodyWidth - w) / 2;
                var y = (bodyHeight - h) / 2;
                var oJson = {
                    hasLoadingAnimation: false
                };
                document.body.exportWindow = SzdwCommon.openExportWindowAssignObj(document.body.exportWindow, pageUrl, paramJson, titleText, x, y, w, h, oJson);
            });
        }

        var szdwResetButton = null;
        function CreateResetButton() {
            var nc = $("#btnPanel");
            var p = "relative";
            var x = 0;
            var y = 0;
            var w = btnWidth;
            var h = btnHeight;
            szdwResetButton = new SzdwButton(p, x, y, w, h);
            szdwResetButton.namingContainer = nc;
            szdwResetButton.image = imgFile.reset;
            szdwResetButton.text = "重置条件";
            szdwResetButton.btnCssJson["border"] = "0px";
            szdwResetButton.btnCssJson["margin-left"] = "5px";
            szdwResetButton.btnCssJson["border-left"] = "1px solid #EEEEEE";
            szdwResetButton.btnHoverCssJson = { "color": "#017BBA" };
            szdwResetButton.imageWidth = btnImageWidth;
            szdwResetButton.Load();

            var btn = szdwResetButton.button;
            $(btn).click(function () {
                $("#txtName").val("");
                $("#txtNameCN").val("");
                $("#ddlDepartmentType").val("全部").data("value", 0);
                $("#ddlDepartment").val("全部").data("value", "-2");
                var btnPanel = szdwQueryButton.button;
                $(btnPanel).trigger("click");
            });
        }

        var szdwInsertButton = null;
        function CreateInsertButton() {
            var nc = $("#btnPanel");
            var p = "relative";
            var x = 0;
            var y = 0;
            var w = btnWidth;
            var h = btnHeight;
            szdwInsertButton = new SzdwButton(p, x, y, w, h);
            szdwInsertButton.namingContainer = nc;
            szdwInsertButton.image = imgFile.insert;
            szdwInsertButton.text = "新增用户";
            szdwInsertButton.btnCssJson["border"] = "0px";
            szdwInsertButton.btnCssJson["margin-left"] = "5px";
            szdwInsertButton.btnCssJson["border-left"] = "1px solid #EEEEEE";
            szdwInsertButton.btnHoverCssJson = { "color": "#017BBA" };
            szdwInsertButton.imageWidth = btnImageWidth;
            szdwInsertButton.Load();

            var btn = szdwInsertButton.button;
            $(btn).click(function () {
                SzdwCommon.hideWin(document.body.exportWindow);
                var titleText = "新增用户信息"
                var pageUrl = "XuserInsert.html";
                var paramJson = {};
                var w = pwWidth;
                var h = GetPanelX("dataPanel", "h");
                var x = bodyWidth - w - ml;
                var y = GetPanelX("dataPanel", "y");
                var oJson = {};
                document.body.popupWindow = SzdwCommon.openEditWindowAssignObj(document.body.popupWindow, pageUrl, paramJson, titleText, x, y, w, h, oJson);
            });
        }

        var szdwRetractButton = null;
        function CreateRetractButton() {
            var nc = $("#btnPanel");
            var p = "relative";
            var x = 0;
            var y = 0;
            var w = 0; //btnWidth;
            var h = btnHeight;
            szdwRetractButton = new SzdwButton(p, x, y, w, h);
            szdwRetractButton.namingContainer = nc;
            szdwRetractButton.btnCssJson["float"] = "right";
            szdwRetractButton.btnCssJson["border"] = "0px";
            szdwRetractButton.btnCssJson["margin-left"] = "5px";
            szdwRetractButton.btnHoverCssJson = { "color": "#017BBA" };
            szdwRetractButton.imageWidth = btnImageWidth;

            szdwRetractButton.isToggle = true;
            szdwRetractButton.imageWidth = btnImageWidth;
            szdwRetractButton.image = imgFile.retractUp;
            szdwRetractButton.imageToggle = imgFile.retractDown;
            szdwRetractButton.title = "收起或展开条件";
            szdwRetractButton.text = "";

            szdwRetractButton.Load();
            //单击事件
            var btn = szdwRetractButton.button;
            $(btn).click(function () {
                //设置控件位置尺寸
                var fp = $("#filterPanel");
                if (fp != null) {
                    if ($(fp).css("display") == "none") {
                        $(fp).fadeIn();
                        $(fp).css("display", "block");
                    } else {
                        $(fp).fadeOut();
                        $(fp).css("display", "none");
                    }
                    RepositionControls();
                    ResizeControls();
                }
            });
        }
        //#region

        //#region gridview
        function GetParamJson() {
            var xuserId = $.parseJSON(SzdwCommon.getUrlParam("paramJson")).xuserId;
            var name = $.trim($("#txtName").val());
            var nameCN = $.trim($("#txtNameCN").val());
            var departmentTypeId = $("#ddlDepartmentType").data("value");
            var departmentId = $("#ddlDepartment").data("value");
            var paramJson = { xuserId: xuserId };
            paramJson["name"] = name;
            paramJson["nameCN"] = nameCN;
            paramJson["departmentTypeId"] = departmentTypeId;
            paramJson["departmentId"] = departmentId;
            return paramJson;
        }

        function GetQueryResult() {
            //设置结果面板相关属性
            var body = document.body;
            var c = $("#dataPanel");
            var position = "absolute";
            var x = 0;
            var y = 0; //by + bh + mt;
            var w = $(c).width();
            var h = $(c).height();

            //创建Gridview并绑定数据
            CreateGridView(c, position, x, y, w, h);
        }

        var szdwGv = null;
        function CreateGridView(namingContainer, position, x, y, width, height) {
            if (szdwGv == null || typeof (szdwGv) == "undefined") {
                //创建SzdwGridViewt实例
                szdwGv = new SzdwGridView(position, x, y, width, height);
                szdwGv.namingContainer = namingContainer;
                szdwGv.fnInitial = InitialArGridview(szdwGv);
                szdwGv.fnExpandButtonGroup = ExpandButtonBind;
                szdwGv.fnDeleting = XuserDelete;
                szdwGv.fnEditing = XuserUpdate;
            }

            //异步加载数据
            if (szdwGv.pagination != null) {
                szdwGv.pagination.ResetBar();
            }

            var paramJson = GetParamJson();
            paramJson["pageSize"] = szdwGv.pageSize;
            paramJson["MethodName"] = "XuserGetList";
            szdwGv.requestUrl = "XuserProcess.ashx";
            szdwGv.paramJson = paramJson;
            szdwGv.DataBind();
        }

        function InitialArGridview(szdwGv) {
            //个性样式设置
            //szdwGv.headCssJson = { "font-weight": "bolder"};        
            szdwGv.dataPanelCssJson = { "background-color": "White", "border": "1px solid Silver" };
            szdwGv.paginationCssJson = { "background-color": "White", "font-family": "微软雅黑", "font-size": "small", "border": "1px solid Silver", "border-top": "0px" };
            szdwGv.minHeight = 300;

            //dataPanel设置
            szdwGv.hasSumRow = false;
            szdwGv.hasButtonPanel = true;
            szdwGv.permission.modifyPermission = permission.modifyPermission;
            szdwGv.permission.deletePermission = permission.deletePermission;

            //head设置
            szdwGv.headCssName = "gridHead2";
            szdwGv.headHeight = 30;
            szdwGv.fieldJsonData = [{ "Field": "RowNumber", "Text": "序号", "Width": 50 },
                                    { "Field": "Name", "Text": "用户名称", "Width": 100, "HasExpandor": true, "OrderField": "Name" },
                                    { "Field": "NameCN", "Text": "中文姓名", "Width": 100, "OrderField": "NameCN" },
                                    { "Field": "GroupName", "Text": "用户组", "Width": 200 },
                                    { "Field": "Role", "Text": "角色", "Width": 200 },
                                    //{ "Field": "", "Text": "签名图片", "Width": 202, "FnControlColumn": CreateImgControl },
                                    { "Field": "FullDepartment", "Text": "单位", "Width": 150 },
                                    { "Field": "Memo", "Text": "用户描述", "Width": 120}];

            szdwGv.cellCssJson = {
                "GroupName": { "text-align": "left" },
                "Role": { "text-align": "left" },
                "FullDepartment": { "text-align": "left" },
                "Memo": { "text-align": "left", "font-size": "small", "font-family": "宋体" }
            };
        }

        function CreateImgControl(jsonList, cell) {
            var rowIndex = $(cell).data("rowIndex");
            var jsData = jsonList[rowIndex];
            var c = document.createElement("div");
            $(c).css({ "height": 40, "line-height": "40px", "float": "center", "text-align": "center" });
            var img = document.createElement("img");
            $(img).prop("src", jsData.SignImg)
                  .addClass("button2")
                  .css({ "width": "187", "height": "40","border-width":"0px" });
            $(c).append(img);
            return c;
        }

        function ExpandButtonBind(gv, field) {
            switch (field) {
                case "Name":
                    gv.expandorBtnJsonList = [{ Text: "重置密码", Title: "密码重置为初始密码", FnClick: ResetPass}];
                    break;
            }
        }

        //重置密码
        function ResetPass() {
            var jsData = szdwGv.recordSetJson;
            if (jsData != null) {
                var ri = szdwGv.expandorRowIndex;
                var id = jsData[ri].Id;
                var modifierId = xuserId;
                var url = "XuserProcess.ashx";
                var paramJson = { id: id, modifierId: modifierId, MethodName: "XuserResetPassword" };
                //重置密码
                $.ajax({ url: url, type: "post", data: paramJson, dataType: "json",
                    success: function (jsonData) {
                        if (jsonData.isReseted) {
                            alert("密码已重置为初始密码。");
                        }
                    }
                });
            }
        }
        //#endregion

        //#region 删改
        //写入后刷新数据
        function RefreshDataAfterInsert() {
            SzdwCommon.refreshDataAfterInsert(szdwGv);
        }

        function XuserDeleteTran(rowIndex) {
            var jsData = szdwGv.recordSetJson[rowIndex];
            var id = jsData.Id;

            var url = "../Xuser/XuserProcess.ashx";
            var paramJson = { xuserId: id, MethodName: "FlowNodeDefaultSettingIsExistedByXuserId" };
            //重置密码
            $.ajax({ url: url, type: "post", data: paramJson, dataType: "json",
                success: function (jsonData) {
                    if (jsonData.isExisted) {
                        alert("此用户为隐患处理中的默认处理人，请先将此人在“节点默认设置”中的默认人员修改之后，在进行删除操作");
                    }
                    else {
                        XuserDelete(rowIndex);
                    }
                }
            });
        }

        function XuserDelete(rowIndex) {
            var jsData = szdwGv.recordSetJson[rowIndex];
            var id = jsData.Id;
            var modifierId = xuserId;

            var requestUrl = "XuserProcess.ashx";
            var paramJson = { id: id, modifierId: modifierId, "MethodName": "XuserLogicDelete" };
            SzdwAjaxDataOperate.ajaxDelete(szdwGv, requestUrl, paramJson);
        }

        function XuserUpdate(rowIndex) {
            SzdwCommon.hideWin(document.body.exportWindow);
            //设置编辑行的样式（加底色）
            szdwGv.SetSelectedRow(szdwGv.bodyRows[rowIndex]);
            var jsData = szdwGv.recordSetJson[rowIndex];
            var titleText = "编辑用户";
            var pageUrl = "XuserUpdate.html";
            var paramJson = { id: jsData.Id, name: jsData.Name, nameCN: jsData.NameCN, departmentId: jsData.DepartmentId, department: jsData.Department,departmentTypeId:jsData.DepartmentTypeId,departmentType:jsData.DepartmentType,signImg:jsData.SignImg, memo: jsData.Memo, modifierId: xuserId };
            var w = pwWidth;
            var h = GetPanelX("dataPanel", "h");
            var x = bodyWidth - w - ml;
            var y = GetPanelX("dataPanel", "y");
            var oJson = { fnCloseCallBack: RecoverSelectedRow };
            document.body.popupWindow = SzdwCommon.openEditWindowAssignObj(document.body.popupWindow, pageUrl, paramJson, titleText, x, y, w, h, oJson);
        }

        //更新完毕后恢复行样式（无选中底色）
        function RecoverSelectedRow() {
            szdwGv.RecoverSelectedRow();
        }
        //#endregion

        var opInfoPanel = null;
        function CreateOperateInfoPanel() {
            opInfoPanel = SzdwCommon.createOperateInfoPanel({ backColor: themeColor, namingContainer: document.body });
            return opInfoPanel;
        }
        //#endregion

        function OpenEmployeeWin(id, name) {
            if (document.body.popupWindow) {
                var popupWindow = document.body.popupWindow
                var titleText = "选取接收人";
                var pageUrl = "PickEmployees.html";
                var paramJson = {};
                var w = 420;
                var h = popupWindow.height;
                var x = popupWindow.x - w;
                var y = popupWindow.y;
                var oJson = {};
                document.body.employeeWindow = SzdwCommon.openExportWindowAssignObj(document.body.employeeWindow, pageUrl, paramJson, titleText, x, y, w, h, oJson);
            }
        }

    </script>
</body>
</html>
