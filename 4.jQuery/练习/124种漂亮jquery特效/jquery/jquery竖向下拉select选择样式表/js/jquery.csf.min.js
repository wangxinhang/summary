/*
LICENCE
*******
CSF Custom Select Form jquery Plugin
@Author : Denis Pissoort
is shared under the terms of the licence Creative Commons Paternité-Partage des Conditions Initiales à l'Identique 2.0 Belgique.
For more information : Author's work Page : http://dipi-graphics.com/labs.html
                       Licence Page : http://creativecommons.org/licenses/by-sa/2.0/be/
*//* 代码整理：懒人之家 lanrenzhijia.com */
(function($){$.fn.customSelectForm=function(n){n=$.extend({prefix:'csf',icon:false},n);this.each(function(){var b=n.prefix+$(this).index();$(this).wrap('<div class="'+b+'"></div>');var c=$(this);var d=c.find('option').get();var e=d.length;var f=n.prefix+'_';var g=c.find('option:selected').index();var h=$('html').not($('div[class^="'+n.prefix+'"]'.children));var j=f+'input';var k=f+'ul';var l=f+'li';var m=f+'btn';$('div.'+b).append('<div class="'+j+'"><p><span class="itemSelected">'+$(d[g]).text()+'</span><a href="#" class="'+m+'"></a></p></div>');$('div.'+b).append('<ul class="'+k+'"></ul>');if(n.icon){for(i=0;i<e;i++){$('div.'+b+' ul.'+k).append('<li class="'+l+'"><a href="#" title="'+$(d[i]).text()+'"><img src="'+$(d[i]).attr("title")+'" class="iconCSF" alt="'+$(d[i]).text()+' icon"/>'+$(d[i]).text()+'</a></li>');if(i==g){$('div.'+b+' ul.'+k).find('li:eq('+g+')').addClass('selected')}}}else{for(i=0;i<e;i++){$('div.'+b+' ul.'+k).append('<li class="'+l+'"><a href="#" title="'+$(d[i]).text()+'">'+$(d[i]).text()+'</a></li>');if(i==g){$('div.'+b+' ul.'+k).find('li:eq('+g+')').addClass('selected')}}}$('div.'+b+' ul.'+k).hide();c.hide();function openCloseList(){var a=$('ul[class^="'+n.prefix+'"]').not($('div.'+b+' ul.'+k));a.prev().children('p').children('a.'+m).removeClass('opened');a.hide();$('div.'+b+' ul.'+k).slideToggle('fast',bindableList);$('div.'+b+' a.'+m).toggleClass('opened');$(this).unbind('click',openCloseList);return false}function selectListItem(){$('div.'+b+' ul.'+k).find('li:eq('+g+')').removeClass('selected');g=$('div.'+b+' ul.'+k).find('li').index($(this).parent());$('div.'+b+' ul.'+k).find('li:eq('+g+')').addClass('selected');var a=$(this).text();$('div.'+b+' div.'+j+' p span.itemSelected').text(a);rebuildSelect();$('div.'+b+' ul.'+k).slideToggle('fast');$('div.'+b+' a.'+m).toggleClass('opened');return false}function bindableList(){$('div.'+b+' div.'+j).bind('click',openCloseList)}function autoClose(){if($('div.'+b+' ul.'+k).css('display')!=="none"){$('div.'+b+' ul.'+k).hide();$('div.'+b+' a.'+m).toggleClass('opened')}}bindableList();$('div.'+b+' ul.'+k+' a').bind('click',selectListItem);h.bind('click',autoClose);function rebuildSelect(){c.html('');for(i=0;i<e;i++){if(i==g){c.append('<option value="'+$(d[i]).val()+'" selected="selected">'+$(d[i]).text()+'</option>')}else{c.append('<option value="'+$(d[i]).val()+'">'+$(d[i]).text()+'</option>')}}}});return this}})(jQuery);